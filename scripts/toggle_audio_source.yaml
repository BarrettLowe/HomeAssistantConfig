# inputs are:
#   speakers: the output audio entity_id
#   source: the source to toggle between
alias: Toggle Audio Source
sequence:
  - service: media_player.select_source
    data_template: 
      entity_id: '{{speakers}}'
      source: >-
        {% if not is_state_attr(speakers,"source",audio_source) %}
        {{audio_source}}
        {% else %}
        Nothing
        {% endif %}
  - condition: state
    entity_id: media_player.snapcast_kitchen
    state: "off"
  - service: rest_command.snapclient_toggle_kitchen